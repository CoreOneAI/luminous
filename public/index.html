<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>Luminous AI - Your Radiant Beauty Companion</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#B8860B">
  <link rel="manifest" href="manifest.json">
  <script>
    // Splash (keep your behavior)
    const splashShown = sessionStorage.getItem('splashShown');
    if (!splashShown) {
      window.location.href = '/splash.html';
    }
  </script>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    :root {
      --primary-charcoal:#2C2C2C;
      --luminous-gold:#B8860B;
      --pearl-white:#F8F8F8;
      --radiant-rose:#E8D5D5;
      --premium-gradient:linear-gradient(135deg,#B8860B,#DAA520);
    }
    body {
      font-family:-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background:var(--primary-charcoal);
      color:#333; overflow-x:hidden; min-height:100vh;
    }
    .container { max-width:414px; margin:0 auto; background:var(--primary-charcoal); min-height:100vh; position:relative; }
    .header { background:var(--primary-charcoal); padding:20px; text-align:center; border-bottom:1px solid #3A3A3A; }
    .logo { font-size:28px; font-weight:700; color:white; margin-bottom:8px;
      background:var(--premium-gradient); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }
    .tagline { font-size:14px; color:var(--luminous-gold); font-weight:500; opacity:.9; }

    .main-content { background:var(--pearl-white); min-height:calc(100vh - 120px); padding:20px; }
    .welcome-section { background:#fff; border-radius:16px; padding:24px; margin-bottom:20px;
      box-shadow:0 4px 12px rgba(0,0,0,.1); text-align:center; }
    .welcome-title { font-size:20px; font-weight:700; color:var(--primary-charcoal); margin-bottom:8px; }
    .welcome-subtitle { font-size:14px; color:#666; margin-bottom:20px; }

    .ai-search-container { margin-bottom:20px; }
    .ai-search-bar { background:#fff; border-radius:25px; padding:16px 20px; display:flex; align-items:center; gap:12px;
      box-shadow:0 4px 12px rgba(0,0,0,.1); border:2px solid var(--luminous-gold); }
    .ai-icon { font-size:20px; color:var(--luminous-gold); }
    .ai-input { flex:1; border:none; outline:none; font-size:14px; color:var(--primary-charcoal); background:transparent; }
    .ai-input::placeholder { color:#999; font-style:italic; }
    .ai-send-btn { background:var(--premium-gradient); border:none; border-radius:20px; width:40px; height:40px; display:flex;
      align-items:center; justify-content:center; color:#fff; cursor:pointer; transition:all .2s; }
    .ai-send-btn:hover { transform:scale(1.05); box-shadow:0 4px 12px rgba(184,134,11,.3); }

    .quick-actions { display:grid; grid-template-columns:repeat(4,1fr); gap:8px; margin-bottom:24px; }
    .action-card { background:#fff; border-radius:12px; padding:8px 6px; text-align:center; box-shadow:0 2px 8px rgba(0,0,0,.1);
      transition:all .2s; cursor:pointer; position:relative; min-height:60px; display:flex; flex-direction:column; justify-content:center; }
    .action-card:hover { transform:translateY(-2px); box-shadow:0 4px 16px rgba(0,0,0,.15); }
    .premium-feature { background:linear-gradient(135deg,#FFF9E6,#FFFFFF); border:1px solid var(--luminous-gold); }
    .premium-star { position:absolute; top:3px; right:3px; font-size:8px; color:var(--luminous-gold); }
    .action-icon { width:28px; height:28px; border-radius:14px; background:var(--premium-gradient); display:flex; align-items:center;
      justify-content:center; margin:0 auto 4px; color:#fff; font-size:12px; }
    .premium-feature .action-icon { background:var(--premium-gradient); box-shadow:0 2px 6px rgba(184,134,11,.3); }
    .action-title { font-size:10px; font-weight:600; color:var(--primary-charcoal); margin-bottom:2px; line-height:1.1; }
    .action-subtitle { font-size:8px; color:#666; line-height:1.1; }

    .featured-section { background:#fff; border-radius:16px; overflow:hidden; box-shadow:0 4px 12px rgba(0,0,0,.1); margin-bottom:20px; }
    .featured-header { background:var(--premium-gradient); color:#fff; padding:16px; text-align:center; cursor:pointer; }
    .featured-title { font-size:16px; font-weight:700; margin-bottom:4px; }
    .featured-subtitle { font-size:12px; opacity:.9; }
    .featured-content { padding:20px; text-align:center; }
    .chat-btn { background:var(--premium-gradient); color:#fff; border:none; padding:16px 32px; border-radius:25px; font-weight:600;
      font-size:16px; cursor:pointer; width:100%; margin-bottom:12px; box-shadow:0 4px 12px rgba(184,134,11,.3); transition:all .2s; }
    .chat-btn:hover { transform:translateY(-2px); box-shadow:0 6px 20px rgba(184,134,11,.4); }
    .features-grid { display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:20px; }
    .feature-card { background:var(--pearl-white); border-radius:12px; padding:16px; text-align:center; cursor:pointer; }
    .feature-icon { font-size:24px; margin-bottom:8px; }
    .feature-title { font-size:12px; font-weight:600; color:var(--primary-charcoal); margin-bottom:4px; }
    .feature-desc { font-size:10px; color:#666; }

    .bottom-nav { background:#fff; height:80px; display:flex; align-items:center; justify-content:space-around; border-top:1px solid #E0E0E0;
      padding-bottom:20px; position:fixed; bottom:0; left:50%; transform:translateX(-50%); width:100%; max-width:414px; }
    .nav-item { display:flex; flex-direction:column; align-items:center; gap:4px; color:#666; text-decoration:none; transition:all .2s; cursor:pointer; }
    .nav-item.active { color:var(--luminous-gold); }
    .nav-icon { width:24px; height:24px; display:flex; align-items:center; justify-content:center; font-size:20px; }
    .nav-label { font-size:10px; font-weight:500; }
    .basket-count { background:var(--luminous-gold); color:#fff; border-radius:10px; padding:2px 6px; font-size:8px; font-weight:700; position:absolute; top:-5px; right:-5px; min-width:16px; text-align:center; }

    @media (max-width:380px){
      .quick-actions { grid-template-columns:1fr 1fr; gap:12px; }
      .action-card { min-height:80px; padding:12px 8px; }
      .action-title { font-size:11px; }
      .action-subtitle { font-size:9px; }
    }

    .loading { display:inline-flex; gap:2px; }
    .dot { width:4px; height:4px; background:var(--luminous-gold); border-radius:50%; animation:pulse 1.5s infinite; }
    .dot:nth-child(2){ animation-delay:.3s; } .dot:nth-child(3){ animation-delay:.6s; }
    @keyframes pulse { 0%,100%{opacity:.3} 50%{opacity:1} }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="logo">‚ú® Luminous AI</div>
      <div class="tagline">Your Radiant Beauty Companion</div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Welcome -->
      <div class="welcome-section">
        <div class="welcome-title">Welcome to Your Beauty Journey</div>
        <div class="welcome-subtitle">Get personalized AI-powered beauty recommendations from global experts</div>

        <!-- Ask AI -->
        <div class="ai-search-container">
          <div class="ai-search-bar">
            <div class="ai-icon">ü§ñ</div>
            <input id="aiInput" class="ai-input" placeholder="Ask: ‚ÄòBest anti-aging serum for sensitive skin‚Äô" />
            <button id="askBtn" class="ai-send-btn" title="Ask">
              <span>‚ú®</span>
            </button>
          </div>
        </div>
        <button class="chat-btn" id="consultBtn">üåü Start Beauty Consultation</button>
      </div>

      <!-- Quick Actions -->
      <div class="quick-actions">
        <div class="action-card premium-feature" data-feature="antiaging">
          <div class="premium-star">‚≠ê</div>
          <div class="action-icon">üßò</div>
          <div class="action-title">Anti-aging</div>
          <div class="action-subtitle">Wellness & skincare</div>
        </div>
        <div class="action-card" data-feature="eyecare">
          <div class="action-icon">üëÅÔ∏è</div>
          <div class="action-title">Eye Care</div>
          <div class="action-subtitle">2,000+ eye products</div>
        </div>
        <div class="action-card premium-feature" data-feature="analysis">
          <div class="premium-star">‚≠ê</div>
          <div class="action-icon">‚ú®</div>
          <div class="action-title">Skin Analysis</div>
          <div class="action-subtitle">AI recommendations</div>
        </div>
        <div class="action-card premium-feature" data-feature="facial">
          <div class="premium-star">‚≠ê</div>
          <div class="action-icon">üòä</div>
          <div class="action-title">Facial Analysis</div>
          <div class="action-subtitle">AI face scanning</div>
        </div>
        <div class="action-card" data-feature="trends">
          <div class="action-icon">üè∑Ô∏è</div>
          <div class="action-title">Discounts</div>
          <div class="action-subtitle">discount products</div>
        </div>
        <div class="action-card" data-feature="nailcare">
          <div class="action-icon">üíÖ</div>
          <div class="action-title">Nail Care</div>
          <div class="action-subtitle">2,000+ nail products</div>
        </div>
        <div class="action-card" data-feature="accessories">
          <div class="action-icon">üíé</div>
          <div class="action-title">Accessories</div>
          <div class="action-subtitle">2,000+ beauty tools</div>
        </div>
        <div class="action-card" data-feature="basket">
          <div class="action-icon">üõí</div>
          <div class="action-title">Basket</div>
          <div class="action-subtitle">3 items ‚Ä¢ $127.50</div>
          <div class="basket-count">3</div>
        </div>
      </div>

      <!-- Featured -->
      <div class="featured-section">
        <div class="featured-header" data-feature="usproducts">
          <div class="featured-title">Beauty Catalog</div>
          <div class="featured-subtitle">Curated American Collections</div>
        </div>
        <div class="featured-content">
          <div class="feature-card" data-feature="international">
            <div class="feature-icon">üåç</div>
            <div class="feature-title">Global Beauty Products</div>
            <div class="feature-desc">Discover products from around the world</div>
          </div>
        </div>
      </div>

      <!-- Recommendations CTA -->
      <div class="featured-section">
        <div class="featured-header">
          <div class="featured-title">Recommendations</div>
          <div class="featured-subtitle">Personalized suggestions</div>
        </div>
        <div class="featured-content">
          <div class="feature-card" id="recCard">
            <div class="feature-icon">‚ú®</div>
            <div class="feature-title">Get Personalized Suggestions</div>
            <div class="feature-desc">Create account or login for AI recommendations</div>
          </div>
        </div>
      </div>

      <div style="height:100px;"></div>
    </div>

    <!-- Bottom Nav -->
    <div class="bottom-nav">
      <div class="nav-item active" data-nav="home">
        <div class="nav-icon">üè†</div>
        <div class="nav-label">Home</div>
      </div>
      <div class="nav-item" data-nav="signin">
        <div class="nav-icon">üîë</div>
        <div class="nav-label">Sign In</div>
      </div>
      <div class="nav-item" data-nav="createaccount">
        <div class="nav-icon">üë§</div>
        <div class="nav-label">Create Account</div>
      </div>
      <div class="nav-item" data-nav="catalog">
        <div class="nav-icon">üåç</div>
        <div class="nav-label">Catalog</div>
      </div>
      <div class="nav-item" data-nav="askme">
        <div class="nav-icon">üí¨</div>
        <div class="nav-label">Ask Me</div>
      </div>
    </div>
  </div>

  <!-- Inline JS (no external index.js needed) -->
  <script>
    // demo basket (unchanged)
    let basket = [
      { name:"K-Beauty Serum", price:"$29.99" },
      { name:"French Moisturizer", price:"$45.50" },
      { name:"Vitamin C Complex", price:"$52.01" }
    ];

    // Ask AI -> POST to your backend (independent, text-only)
    async function askBackend(message){
      // Prefer /ask (your working endpoint), then fallback to /api/chat or /chat
      const endpoints = ['/ask','/api/chat','/chat'];
      let lastErr = null;
      for (const ep of endpoints){
        try{
          const r = await fetch(ep, {
            method:'POST',
            headers:{ 'Content-Type':'application/json', 'Accept':'application/json' },
            body: JSON.stringify({ message, includeProducts:false })
          });
          if (!r.ok) throw new Error('HTTP '+r.status);
          const data = await r.json().catch(()=> ({}));
          // support shapes: {reply} or {response} or {text}
          return data.reply || data.response || data.text || '';
        }catch(err){ lastErr = err; }
      }
      throw lastErr || new Error('All endpoints failed');
    }

    function showBtnThinking(btn, on=true){
      if (!btn) return;
      btn.disabled = on;
      const span = btn.querySelector('span');
      if (!span) return;
      span.innerHTML = on
        ? '<div class="loading"><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>'
        : '‚ú®';
    }

    async function startChat(){
      const input = document.getElementById('aiInput');
      const btn = document.getElementById('askBtn');
      const query = (input?.value || '').trim();
      if (!query) { alert('Please enter a beauty question.'); return; }
      showBtnThinking(btn,true);
      try{
        const text = await askBackend(query);
        alert(text ? 'üí° AI Suggestion:\n\n' + text : '‚ö†Ô∏è No response received. Please try again.');
      }catch(e){
        console.error('Chat error:', e);
        alert('‚ö†Ô∏è Could not reach AI right now. Please try again in a moment.');
      }finally{
        showBtnThinking(btn,false);
      }
    }

    // Feature router (kept as you had)
    function openFeature(feature){
      switch(feature){
        case 'trends':
          location.href = '/chat.html?query=Show me the latest trending beauty products and viral looks from TikTok and Instagram';
          break;
        case 'eyecare':
          location.href = '/chat.html?query=eye care&source=eyecare';
          break;
        case 'international':
          location.href = '/catalog.html';
          break;
        case 'facial':
          showFacialAnalysisPrompt();
          break;
        case 'analysis':
          location.href = '/account.html?tab=profile#skin-analysis';
          break;
        case 'antiaging':
          location.href = '/antiaging.html';
          break;
        case 'nailcare':
          location.href = '/chat.html?query=nail care&source=nailcare';
          break;
        case 'accessories':
          location.href = '/chat.html?query=beauty accessories&source=accessories';
          break;
        case 'basket':
          showBasket();
          break;
        case 'usproducts':
          location.href = '/chat.html?query=Show me US and local beauty care products including American brands, locally sourced ingredients, and products made in the USA';
          break;
        default:
          startChat();
      }
    }

    function goToPage(page){
      document.querySelectorAll('.nav-item').forEach(i=> i.classList.remove('active'));
      if (event?.currentTarget) event.currentTarget.classList.add('active');
      switch(page){
        case 'home': location.href='/index.html'; break;
        case 'signin': location.href='/signin.html'; break;
        case 'createaccount': location.href='/createaccount.html'; break;
        case 'catalog': location.href='/catalog.html'; break;
        case 'askme': location.href='/askme.html'; break;
      }
    }

    function showBasket(){
      const items = basket.map(i => `‚Ä¢ ${i.name} - ${i.price}`).join('\n');
      alert(`üõí Your Beauty Basket:\n\n${items}\n\nTotal: $127.50\n\nCheckout coming soon!`);
    }

    function showAccountPrompt(){
      const html = `
      <div style="position:fixed;inset:0;background:rgba(0,0,0,.8);z-index:10000;display:flex;align-items:center;justify-content:center;padding:20px;" onclick="closeAccountPrompt()">
        <div style="background:#fff;border-radius:20px;padding:30px;max-width:350px;text-align:center;" onclick="event.stopPropagation()">
          <div style="font-size:48px;margin-bottom:20px;">‚ú®</div>
          <h2 style="color:#2c2c2c;margin-bottom:15px;font-size:22px;">Get Personalized Recommendations</h2>
          <p style="color:#666;margin-bottom:25px;line-height:1.5;">Create an account or sign in to receive AI-powered beauty recommendations tailored just for you!</p>
          <div style="display:flex;flex-direction:column;gap:12px;">
            <button onclick="location.href='createaccount.html'" style="background:var(--premium-gradient);color:#fff;border:none;padding:15px 25px;border-radius:25px;font-weight:600;cursor:pointer;font-size:16px;">Create Account</button>
            <button onclick="location.href='signin.html'" style="background:#f0f0f0;color:#333;border:none;padding:15px 25px;border-radius:25px;font-weight:600;cursor:pointer;font-size:16px;">Sign In</button>
            <button onclick="closeAccountPrompt()" style="background:none;border:none;color:#888;padding:10px;cursor:pointer;font-size:14px;">Maybe Later</button>
          </div>
        </div>
      </div>`;
      document.body.insertAdjacentHTML('beforeend', html);
    }
    function closeAccountPrompt(){
      const ov = document.querySelector('[style*="position:fixed"][style*="z-index: 10000"]'); if (ov) ov.remove();
    }

    function showFacialAnalysisPrompt(){
      const html = `
      <div style="position:fixed;inset:0;background:rgba(0,0,0,.8);z-index:10000;display:flex;align-items:center;justify-content:center;padding:20px;" onclick="closeFacialAnalysisPrompt()">
        <div style="background:#fff;border-radius:20px;padding:30px;max-width:350px;text-align:center;" onclick="event.stopPropagation()">
          <div style="font-size:48px;margin-bottom:20px;">üòä</div>
          <h2 style="color:#2c2c2c;margin-bottom:15px;font-size:22px;">AI Facial Analysis</h2>
          <p style="color:#666;margin-bottom:25px;line-height:1.5;">Create an account and complete your profile to access our AI-powered facial analysis tool for personalized beauty recommendations!</p>
          <div style="display:flex;flex-direction:column;gap:12px;">
            <button onclick="location.href='createaccount.html'" style="background:var(--premium-gradient);color:#fff;border:none;padding:15px 25px;border-radius:25px;font-weight:600;cursor:pointer;font-size:16px;">Create Account</button>
            <button onclick="location.href='signin.html'" style="background:#f0f0f0;color:#333;border:none;padding:15px 25px;border-radius:25px;font-weight:600;cursor:pointer;font-size:16px;">Sign In</button>
            <button onclick="closeFacialAnalysisPrompt()" style="background:none;border:none;color:#888;padding:10px;cursor:pointer;font-size:14px;">Continue as Guest</button>
          </div>
        </div>
      </div>`;
      document.body.insertAdjacentHTML('beforeend', html);
    }
    function closeFacialAnalysisPrompt(){ closeAccountPrompt(); }

    // Wire up interactions
    document.addEventListener('DOMContentLoaded', ()=>{
      console.log('‚ú® Luminous AI loaded');
      const logo = document.querySelector('.logo');
      setInterval(()=>{ logo.style.transform='scale(1.02)'; setTimeout(()=>{ logo.style.transform='scale(1)'; },200); },3000);

      document.getElementById('aiInput')?.addEventListener('keydown', (e)=>{ if(e.key==='Enter') startChat(); });
      document.getElementById('askBtn')?.addEventListener('click', startChat);
      document.getElementById('consultBtn')?.addEventListener('click', startChat);

      document.querySelectorAll('.action-card').forEach(card=>{
        card.addEventListener('click', ()=>{
          card.style.transform='scale(0.95)';
          setTimeout(()=> card.style.transform='', 100);
          openFeature(card.dataset.feature);
        });
      });

      document.getElementById('recCard')?.addEventListener('click', ()=>{
        const profile = JSON.parse(localStorage.getItem('userProfile')||'{}');
        if (profile.name && profile.email && profile.password) location.href='account.html';
        else showAccountPrompt();
      });

      document.querySelectorAll('.nav-item').forEach(nav=>{
        nav.addEventListener('click', ()=> goToPage(nav.dataset.nav));
      });
    });
  </script>
</body>
</html>
