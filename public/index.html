<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Luminous Salon</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    /* Browser Background */
    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }
    
    /* Phone Container */
    .phone-frame {
      width: 375px;
      height: 812px;
      background: #000;
      border-radius: 40px;
      padding: 10px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      position: relative;
      overflow: hidden;
    }
    
    /* Phone Screen */
    .phone-screen {
      width: 100%;
      height: 100%;
      background: #fff;
      border-radius: 30px;
      overflow: hidden;
      position: relative;
      display: flex;
      flex-direction: column;
    }
    
    /* Flutter AppBar */
    .app-bar {
      background: #000;
      color: #fff;
      height: 56px;
      display: flex;
      align-items: center;
      padding: 0 4px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .app-bar-leading {
      width: 48px;
      height: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }
    
    .app-bar-title {
      flex: 1;
      text-align: center;
      font-size: 18px;
      font-weight: 600;
      margin-right: 48px;
    }
    
    /* Flutter Scaffold Body */
    .scaffold-body {
      flex: 1;
      overflow-y: auto;
      background: #fafafa;
      position: relative;
    }
    
    /* Grid View */
    .grid-view {
      padding: 8px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }
    
    /* Category Cards */
    .category-card {
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,0.12);
      text-decoration: none;
      color: inherit;
      cursor: pointer;
    }
    
    .category-image {
      width: 100%;
      height: 100px;
      position: relative;
      overflow: hidden;
    }
    
    .category-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }
    
    .category-card:hover .category-image img {
      transform: scale(1.05);
    }
    
    .category-body {
      padding: 10px;
    }
    
    .category-title {
      font-size: 13px;
      font-weight: 600;
      color: 212121;
      margin: 4px 0;
      line-height: 1.2;
    }
    
    .category-subtitle {
      font-size: 11px;
      color: #757575;
      line-height: 1.2;
    }
    
    /* Hero Banner */
    .hero-banner {
      background: linear-gradient(135deg, #000 0%, #333 100%);
      color: #fff;
      padding: 16px;
      margin: 8px;
      border-radius: 12px;
    }
    
    .hero-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 4px;
    }
    
    .hero-text {
      font-size: 12px;
      opacity: 0.9;
    }
    
    /* Quick Actions */
    .quick-actions {
      padding: 8px;
      display: flex;
      gap: 8px;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    
    .quick-actions::-webkit-scrollbar {
      display: none;
    }
    
    .action-button {
      flex: 0 0 auto;
      padding: 8px 16px;
      background: #000;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .action-button:active {
      background: #333;
    }
    
    /* Section Label */
    .section-label {
      padding: 12px 12px 4px;
      font-size: 14px;
      font-weight: 600;
      color: #000;
    }
    
    /* Products Scroll */
    .products-scroll {
      padding: 8px;
      display: flex;
      gap: 8px;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    
    .products-scroll::-webkit-scrollbar {
      display: none;
    }
    
    .mini-product {
      flex: 0 0 120px;
      background: #fff;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 1px 3px rgba(0,0,0,0.12);
      cursor: pointer;
    }
    
    .mini-product-image {
      width: 100%;
      height: 80px;
      position: relative;
      overflow: hidden;
    }
    
    .mini-product-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .mini-product-info {
      padding: 8px;
    }
    
    .mini-product-name {
      font-size: 11px;
      font-weight: 600;
      margin-bottom: 2px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    .mini-product-price {
      font-size: 13px;
      font-weight: 700;
      color: #000;
    }
    
    /* Promo Card */
    .promo-card {
      margin: 8px;
      padding: 12px;
      background: linear-gradient(135deg, #000000 0%, #000000 100%);
      border-radius: 12px;
      color: #fff;
    }
    
    .promo-title {
      font-size: 14px;
      font-weight: 700;
      margin-bottom: 2px;
      color: #C9A961;
    }
    
    .promo-text {
      font-size: 11px;
      opacity: 0.95;
    }
    
    /* Bottom Navigation */
    .bottom-nav {
      background: #fff;
      height: 56px;
      border-top: 1px solid #e0e0e0;
      display: flex;
      align-items: center;
      justify-content: space-around;
    }
    
    .nav-item {
      flex: 1;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      color: #757575;
      transition: all 0.2s;
      text-decoration: none;
    }
    
    .nav-item.active {
      color: #000;
    }
    
    .nav-label {
      font-size: 10px;
      font-weight: 500;
    }
    
    /* Floating Action Button */
    .fab {
      position: absolute;
      bottom: 70px;
      right: 16px;
      width: 56px;
      height: 56px;
      background: #000;
      color: #fff;
      border-radius: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
      cursor: pointer;
      font-size: 24px;
      z-index: 10;
      transition: all 0.2s;
    }
    
    .fab:hover {
      transform: scale(1.05);
    }
    
    .fab:active {
      transform: scale(0.95);
    }
    
    /* Chat Container Styles */
    .chat-container {
      padding: 8px;
    }
    
    .chat-box {
      background: #fff;
      border-radius: 12px;
      padding: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.12);
    }
    
    .chat-messages {
      height: 200px;
      overflow-y: auto;
      background: #f9f9f9;
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 10px;
      display: flex;
      flex-direction: column;
    }
    
    .chat-message {
      padding: 8px;
      margin: 4px 0;
      border-radius: 8px;
      font-size: 12px;
      max-width: 80%;
    }
    
    .chat-message.bot {
      background: #e0e0e0;
      align-self: flex-start;
    }
    
    .chat-message.user {
      background: #000;
      color: white;
      align-self: flex-end;
      margin-left: auto;
    }
    
    .chat-input-container {
      display: flex;
      gap: 8px;
    }
    
    .chat-input {
      flex: 1;
      padding: 10px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      font-size: 13px;
    }
    
    .chat-send {
      padding: 10px 20px;
      background: #000;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
    }
    
    /* Search Container */
    .search-container {
      padding: 8px;
    }
    
    .search-box {
      background: #fff;
      border-radius: 12px;
      padding: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.12);
    }
    
    .search-input-container {
      display: flex;
      gap: 8px;
    }
    
    .search-input {
      flex: 1;
      padding: 10px;
      border: 1px solid #e0e0e0;
      border-radius: 8px;
      font-size: 13px;
    }
    
    .search-button {
      padding: 10px 20px;
      background: #C9A961;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 600;
      cursor: pointer;
    }
    
    /* Modal Styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.8);
      z-index: 1000;
      display: none;
      justify-content: center;
      align-items: center;
    }
    
    .product-modal {
      background: white;
      padding: 20px;
      border-radius: 12px;
      max-width: 90%;
      max-height: 80%;
      overflow-y: auto;
      z-index: 1001;
    }
    
    /* Responsive */
    @media (max-width: 425px) {
      .phone-frame {
        width: 100%;
        height: 100vh;
        border-radius: 0;
        padding: 0;
      }
      
      .phone-screen {
        border-radius: 0;
      }
    }
  </style>
</head>
<body>
  <!-- Phone Frame Container -->
  <div class="phone-frame">
    <div class="phone-screen">
      
      <!-- Flutter AppBar -->
      <div class="app-bar">
        <div class="app-bar-leading">
          <span style="font-size: 20px;">üîî</span>
        </div>
        <div class="app-bar-title">Luminous Salon</div>
      </div>
      
      <!-- Main View -->
      <div class="scaffold-body" id="mainView">
        
        <!-- Hero Banner -->
        <div class="hero-banner">
          <div class="hero-title">Welcome to Luminous</div>
          <div class="hero-text">Your premier beauty destination</div>
        </div>
        
        <!-- Quick Actions -->
        <div class="quick-actions">
          <button class="action-button" onclick="bookNow()">
            <span style="font-size: 16px;">üìÖ</span> Book Now
          </button>
          <button class="action-button" onclick="callUs()">
            <span style="font-size: 16px;">üìû</span> Call Us
          </button>
          <button class="action-button" onclick="viewOffers()">
            <span style="font-size: 16px;">üéÅ</span> Services
          </button>
          <button class="action-button" onclick="rewards()">
            <span style="font-size: 16px;">‚≠ê</span> Rewards
          </button>
        </div>
        
        <!-- AI Chat Section -->
        <div class="section-label">Ask Our Beauty Expert</div>
        <div class="chat-container">
          <div class="chat-box">
            <div id="chatContainer" class="chat-messages">
              <div class="chat-message bot">
                Welcome! Ask me anything about skincare, haircare, or beauty treatments.
              </div>
            </div>
            
            <div class="chat-input-container">
              <input id="chatInput" type="text" placeholder="Ask about treatments, products, or beauty advice..." 
                     class="chat-input" onkeypress="if(event.key === 'Enter') sendChat()">
              <button onclick="sendChat()" class="chat-send">Send</button>
            </div>
          </div>
        </div>
        
        <!-- Product Search Bar -->
        <div class="section-label">Search Products</div>
        <div class="search-container">
          <div class="search-box">
            <div class="search-input-container">
              <input id="productSearch" type="text" placeholder="Search for specific products..." 
                     class="search-input" onkeypress="if(event.key === 'Enter') searchProducts()">
              <button onclick="searchProducts()" class="search-button">Search</button>
            </div>
          </div>
        </div>
        
        <!-- Shop Categories -->
        <div class="section-label">Shop by Category</div>
        <div class="grid-view">
          <div class="category-card" onclick="showProducts('Anti-Aging')">
            <div class="category-image">
              <img src="/images/anti-aging.jpg" alt="Anti-Aging" onerror="handleImageError(this)">
            </div>
            <div class="category-body">
              <div class="category-title">Anti-Aging</div>
              <div class="category-subtitle">Retinol & peptide treatments</div>
            </div>
          </div>
          
          <div class="category-card" onclick="showProducts('Skin Care')">
            <div class="category-image">
              <img src="/images/skin-care.jpg" alt="Skin Care" onerror="handleImageError(this)">
            </div>
            <div class="category-body">
              <div class="category-title">Skin Care</div>
              <div class="category-subtitle">Cleansers & toners</div>
            </div>
          </div>
          
          <div class="category-card" onclick="showProducts('Eye Care')">
            <div class="category-image">
              <img src="/images/eye-care.jpg" alt="Eye Care" onerror="handleImageError(this)">
            </div>
            <div class="category-body">
              <div class="category-title">Eye Care</div>
              <div class="category-subtitle">Serums & treatments</div>
            </div>
          </div>
          
          <div class="category-card" onclick="showProducts('Brightening')">
            <div class="category-image">
              <img src="/images/brightening.jpg" alt="Brightening" onerror="handleImageError(this)">
            </div>
            <div class="category-body">
              <div class="category-title">Brightening</div>
              <div class="category-subtitle">Vitamin C & glow products</div>
            </div>
          </div>

          <div class="category-card" onclick="showProducts('Daily Protection')">
            <div class="category-image">
              <img src="/images/daily-protection.jpg" alt="Daily Protection" onerror="handleImageError(this)">
            </div>
            <div class="category-body">
              <div class="category-title">Daily Protection</div>
              <div class="category-subtitle">SPF & sun care</div>
            </div>
          </div>
          
          <div class="category-card" onclick="showProducts('Night Cream')">
            <div class="category-image">
              <img src="/images/night-cream.jpg" alt="Night Cream" onerror="handleImageError(this)">
            </div>
            <div class="category-body">
              <div class="category-title">Night Cream</div>
              <div class="category-subtitle">Overnight repair</div>
            </div>
          </div>

          <div class="category-card" onclick="showProducts('Eye')">
            <div class="category-image">
              <img src="/images/targeted-eye.jpg" alt="Targeted Eye" onerror="handleImageError(this)">
            </div>
            <div class="category-body">
              <div class="category-title">Targeted Eye</div>
              <div class="category-subtitle">Specialized eye treatments</div>
            </div>
          </div>
          
          <div class="category-card" onclick="showProducts('all')">
            <div class="category-image">
              <img src="/images/all-products.jpg" alt="All Products" onerror="handleImageError(this)">
            </div>
            <div class="category-body">
              <div class="category-title">All Products</div>
              <div class="category-subtitle">Browse everything</div>
            </div>
          </div>
        </div>
        
        <!-- Promo -->
        <div class="promo-card">
          <div class="promo-title">New Client Special</div>
          <div class="promo-text">Get 20% off your first treatment + free consultation</div>
        </div>
        
        <!-- Featured Products -->
        <div class="section-label">Bestsellers</div>
        <div class="products-scroll" id="featuredProducts">
          <!-- Products will be loaded here -->
        </div>
        
        <!-- Services -->
        <div class="section-label">Our Services</div>
        <div class="grid-view">
          <div class="category-card" onclick="bookService('color')">
            <div class="category-image">
              <img src="/images/hair-color.jpg" alt="Color & Highlights" onerror="handleImageError(this)">
            </div>
            <div class="category-body">
              <div class="category-title">Color & Highlights</div>
              <div class="category-subtitle">Starting at $120</div>
            </div>
          </div>
          
          <div class="category-card" onclick="bookService('styling')">
            <div class="category-image">
              <img src="/images/styling-makeup.jpg" alt="Styling & Makeup" onerror="handleImageError(this)">
            </div>
            <div class="category-body">
              <div class="category-title">Styling & Makeup</div>
              <div class="category-subtitle">Starting at $85</div>
            </div>
          </div>
        </div>
        
        <!-- Floating Action Button -->
        <div class="fab" onclick="openAI()">üí¨</div>
        
      </div>
      
      <!-- Bottom Navigation -->
      <div class="bottom-nav">
        <a class="nav-item active" onclick="goHome()">
          <span style="font-size: 20px;">üè†</span>
          <div class="nav-label">Home</div>
        </a>
        <a class="nav-item" onclick="navigateTo('services')">
          <span style="font-size: 20px;">‚úÇÔ∏è</span>
          <div class="nav-label">Services</div>
        </a>
        <a class="nav-item" onclick="navigateTo('products')">
          <span style="font-size: 20px;">üõçÔ∏è</span>
          <div class="nav-label">Products</div>
        </a>
        <a class="nav-item" onclick="showProfile()">
          <span style="font-size: 20px;">üë§</span>
          <div class="nav-label">Profile</div>
        </a>
      </div>
    </div>
  </div>

  <!-- Modal Overlay -->
  <div class="modal-overlay" id="modalOverlay" onclick="closeModal()"></div>

<script>
    // Current cart
    let cart = {
        items: [],
        total: 0
    };

    // Handle image errors
    function handleImageError(img) {
        img.style.display = 'none';
    }

    // Load products from API
    async function loadProducts() {
        try {
            const response = await fetch('/api/products');
            const data = await response.json();
            
            // FIX: Check the correct response structure
            const products = data.items || data.products || [];
            
            if (products.length > 0) {
                displayProducts(products.slice(0, 6));
            } else {
                displayProducts(getFallbackProducts().slice(0, 6));
            }
        } catch (error) {
            console.error('Error loading products:', error);
            displayProducts(getFallbackProducts().slice(0, 6));
        }
    }

    // Show products by category - FIXED
    async function showProducts(category) {
        try {
            let url = '/api/products';
            if (category !== 'all') {
                url += `?category=${encodeURIComponent(category)}`;
            }
            
            const response = await fetch(url);
            const data = await response.json();
            
            // FIX: Check the correct response structure
            const products = data.items || data.products || [];
            
            if (products.length > 0) {
                showProductsModal(products, category);
            } else {
                addChatMessage('bot', `No products found in ${category} category.`);
            }
        } catch (error) {
            console.error('Error loading products:', error);
            addChatMessage('bot', 'Sorry, having trouble loading products. Please try again.');
        }
    }

    // Show products in a modal - IMPROVED
    function showProductsModal(products, category) {
        const overlay = document.getElementById('modalOverlay');
        overlay.innerHTML = '';
        overlay.style.display = 'flex';
        
        const modal = document.createElement('div');
        modal.className = 'product-modal';
        modal.style.width = '320px';
        modal.style.maxHeight = '500px';
        modal.style.overflowY = 'auto';
        
        const title = document.createElement('h3');
        title.textContent = `${category} Products (${products.length})`;
        title.style.marginBottom = '15px';
        title.style.textAlign = 'center';
        title.style.color = '#333';
        modal.appendChild(title);
        
        // Create product grid (2 per row)
        const productGrid = document.createElement('div');
        productGrid.style.display = 'grid';
        productGrid.style.gridTemplateColumns = '1fr 1fr';
        productGrid.style.gap = '10px';
        productGrid.style.padding = '10px';
        
        products.forEach(product => {
            const productCard = document.createElement('div');
            productCard.style.background = '#fff';
            productCard.style.borderRadius = '8px';
            productCard.style.padding = '10px';
            productCard.style.boxShadow = '0 2px 4px rgba(0,0,0,0.1)';
            productCard.style.cursor = 'pointer';
            productCard.style.transition = 'transform 0.2s';
            
            productCard.onmouseenter = () => {
                productCard.style.transform = 'translateY(-2px)';
            };
            
            productCard.onmouseleave = () => {
                productCard.style.transform = 'none';
            };
            
            productCard.onclick = () => showProductDetailModal(product);
            
            const imageContainer = document.createElement('div');
            imageContainer.style.height = '80px';
            imageContainer.style.marginBottom = '8px';
            imageContainer.style.borderRadius = '6px';
            imageContainer.style.overflow = 'hidden';
            imageContainer.style.background = 'linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%)';
            
            const imageHtml = product.image ? 
                `<img src="${product.image}" alt="${product.name}" style="width: 100%; height: 100%; object-fit: cover;" onerror="handleImageError(this)">` :
                '<div style="display: flex; align-items: center; justify-content: center; height: 100%; font-size: 24px;">üíÑ</div>';
            
            imageContainer.innerHTML = imageHtml;
            
            const productName = document.createElement('div');
            productName.textContent = product.name.length > 20 ? product.name.substring(0, 20) + '...' : product.name;
            productName.style.fontWeight = '600';
            productName.style.fontSize = '12px';
            productName.style.marginBottom = '4px';
            productName.style.color = '#333';
            
            const productPrice = document.createElement('div');
            productPrice.textContent = `$${product.price.toFixed(2)}`;
            productPrice.style.fontWeight = '700';
            productPrice.style.color = '#C9A961';
            productPrice.style.fontSize = '14px';
            
            productCard.appendChild(imageContainer);
            productCard.appendChild(productName);
            productCard.appendChild(productPrice);
            
            productGrid.appendChild(productCard);
        });
        
        modal.appendChild(productGrid);
        overlay.appendChild(modal);
    }

    // Show individual product detail modal
    function showProductDetailModal(product) {
        const overlay = document.getElementById('modalOverlay');
        overlay.innerHTML = '';
        
        const modal = document.createElement('div');
        modal.className = 'product-modal';
        modal.style.width = '300px';
        
        const imageContainer = document.createElement('div');
        imageContainer.style.height = '150px';
        imageContainer.style.marginBottom = '15px';
        imageContainer.style.borderRadius = '8px';
        imageContainer.style.overflow = 'hidden';
        imageContainer.style.background = 'linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%)';
        
        const imageHtml = product.image ? 
            `<img src="${product.image}" alt="${product.name}" style="width: 100%; height: 100%; object-fit: cover;" onerror="handleImageError(this)">` :
            '<div style="display: flex; align-items: center; justify-content: center; height: 100%; font-size: 40px;">üíÑ</div>';
        
        imageContainer.innerHTML = imageHtml;
        
        const productName = document.createElement('h3');
        productName.textContent = product.name;
        productName.style.marginBottom = '8px';
        productName.style.color = '#333';
        productName.style.textAlign = 'center';
        
        const productPrice = document.createElement('div');
        productPrice.textContent = `Price: $${product.price.toFixed(2)}`;
        productPrice.style.fontWeight = '700';
        productPrice.style.color = '#C9A961';
        productPrice.style.fontSize = '18px';
        productPrice.style.textAlign = 'center';
        productPrice.style.marginBottom = '12px';
        
        const productBrand = document.createElement('div');
        productBrand.textContent = `Brand: ${product.brand || 'Luminous'}`;
        productBrand.style.color = '#666';
        productBrand.style.fontSize = '12px';
        productBrand.style.marginBottom = '8px';
        productBrand.style.textAlign = 'center';
        
        const productDescription = document.createElement('div');
        productDescription.textContent = product.description || 'No description available.';
        productDescription.style.color = '#555';
        productDescription.style.fontSize = '12px';
        productDescription.style.marginBottom = '20px';
        productDescription.style.lineHeight = '1.4';
        productDescription.style.textAlign = 'center';
        
        const addToCartBtn = document.createElement('button');
        addToCartBtn.textContent = 'Add to Cart';
        addToCartBtn.style.background = '#C9A961';
        addToCartBtn.style.color = 'white';
        addToCartBtn.style.border = 'none';
        addToCartBtn.style.padding = '12px 20px';
        addToCartBtn.style.borderRadius = '8px';
        addToCartBtn.style.cursor = 'pointer';
        addToCartBtn.style.width = '100%';
        addToCartBtn.style.fontWeight = '600';
        addToCartBtn.onclick = () => {
            addToCart(product);
            closeModal();
        };
        
        modal.appendChild(imageContainer);
        modal.appendChild(productName);
        modal.appendChild(productPrice);
        modal.appendChild(productBrand);
        modal.appendChild(productDescription);
        modal.appendChild(addToCartBtn);
        
        overlay.appendChild(modal);
    }

    // Close modal
    function closeModal() {
        const overlay = document.getElementById('modalOverlay');
        overlay.style.display = 'none';
        overlay.innerHTML = '';
    }

    // Add to cart function
    function addToCart(product) {
        cart.items.push(product);
        cart.total += product.price;
        
        addChatMessage('bot', `Added ${product.name} to cart! Total: $${cart.total.toFixed(2)}`);
    }

    // Fallback products
    function getFallbackProducts() {
        return [
            {
                id: "aa-retinol-serum-001",
                name: "Retinol Renewal Serum 0.3%",
                brand: "Luminous Lab",
                category: "Anti-Aging",
                price: 39.00,
                description: "Gentle retinol serum for first-time users. Softens fine lines and improves texture.",
                image: "/images/0010.jpg"
            },
            {
                id: "ec-ceramide-eye-002",
                name: "Ceramide Eye Repair Gel",
                brand: "Luminous Lab", 
                category: "Eye Care",
                price: 22.00,
                description: "Cooling gel with caffeine and ceramides for morning depuff and long-lasting hydration.",
                image: "/images/black-americanfemale.jpg"
            },
            {
                id: "sc-balancing-002",
                name: "Balancing Gel Cleanser", 
                brand: "Salon Pro",
                category: "Skin Care",
                price: 14.00,
                description: "pH-balanced gel cleanser that removes makeup without stripping.",
                image: "/images/0014CC.jpg"
            }
        ];
    }

    // Display featured products
    function displayProducts(products) {
        const container = document.getElementById('featuredProducts');
        if (!container) return;
        
        container.innerHTML = '';
        
        products.forEach(product => {
            const productElement = document.createElement('div');
            productElement.className = 'mini-product';
            productElement.onclick = () => showProductDetailModal(product);
            
            const imageHtml = product.image ? 
                `<img src="${product.image}" alt="${product.name}" onerror="handleImageError(this)">` :
                '<div style="font-size: 24px; display: flex; align-items: center; justify-content: center; height: 100%; background: linear-gradient(135deg, #f5f5f5 0%, #e8e8e8 100%);">üíÑ</div>';
            
            productElement.innerHTML = `
                <div class="mini-product-image">
                    ${imageHtml}
                </div>
                <div class="mini-product-info">
                    <div class="mini-product-name">${product.name}</div>
                    <div class="mini-product-price">$${product.price.toFixed(2)}</div>
                </div>
            `;
            container.appendChild(productElement);
        });
    }

    // Chat function with AI integration
    async function sendChat() {
        const input = document.getElementById('chatInput');
        if (!input) return;
        
        const message = input.value.trim();
        if (!message) return;
        
        addChatMessage('user', message);
        input.value = '';
        
        try {
            const response = await fetch('/ask', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ message: message })
            });
            
            if (!response.ok) {
                throw new Error(`API error: ${response.status}`);
            }
            
            const data = await response.json();
            const aiReply = data.reply || data.choices?.[0]?.message?.content || "Sorry, I couldn't process that.";
            
            addChatMessage('bot', aiReply);
            
        } catch (error) {
            console.error('Chat error:', error);
            
            setTimeout(() => {
                const lowerMsg = message.toLowerCase();
                let response;
                
                if (lowerMsg.includes('retinol') || lowerMsg.includes('anti-aging')) {
                    response = "Our retinol products are perfect for anti-aging! Try our Retinol Renewal Serum for gentle yet effective results.";
                } else if (lowerMsg.includes('eye') || lowerMsg.includes('dark circles')) {
                    response = "For eye care, we recommend our Ceramide Eye Repair Gel or Brightening Eye Serum for dark circles.";
                } else if (lowerMsg.includes('vitamin c') || lowerMsg.includes('bright')) {
                    response = "Our Vitamin C 15% Bright Serum is excellent for radiant skin and even tone.";
                } else if (lowerMsg.includes('spf') || lowerMsg.includes('sun')) {
                    response = "Protect your skin with our Daily Mineral SPF 30 or Ultra Light SPF 50 for weightless protection.";
                } else if (lowerMsg.includes('service') || lowerMsg.includes('book') || lowerMsg.includes('appointment')) {
                    response = "I can help you book services! We offer hair coloring ($120), facials ($90), manicures ($45), and more. What are you interested in?";
                } else if (lowerMsg.includes('product') || lowerMsg.includes('buy')) {
                    response = "Check out our products by category: Anti-Aging, Eye Care, Skin Care, Brightening, Daily Protection, or browse all products.";
                } else {
                    response = "I'm here to help with beauty advice, product recommendations, and salon services. What would you like to know?";
                }
                
                addChatMessage('bot', response);
            }, 1000);
        }
    }

    function searchProducts() {
        const searchTerm = document.getElementById('productSearch').value.trim();
        if (searchTerm) {
            addChatMessage('user', `Search: ${searchTerm}`);
            document.getElementById('productSearch').value = '';
            
            setTimeout(async () => {
                try {
                    const response = await fetch('/ask', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ 
                            message: `I'm searching for products related to: ${searchTerm}. What do you recommend from your catalog?` 
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        const aiReply = data.reply || data.choices?.[0]?.message?.content;
                        addChatMessage('bot', aiReply);
                    } else {
                        addChatMessage('bot', `I found several products matching "${searchTerm}". Check our categories for the best matches!`);
                    }
                } catch (error) {
                    addChatMessage('bot', `Searching for "${searchTerm}"... Check our categories for related products!`);
                }
            }, 1000);
        }
    }

    // Chat functions
    function addChatMessage(type, message) {
        const chatContainer = document.getElementById('chatContainer');
        if (!chatContainer) return;
        
        const messageDiv = document.createElement('div');
        messageDiv.className = `chat-message ${type}`;
        messageDiv.textContent = message;
        chatContainer.appendChild(messageDiv);
        chatContainer.scrollTop = chatContainer.scrollHeight;
    }

    // Navigation functions
    function goHome() {
        document.querySelectorAll('.nav-item').forEach(item => {
            item.classList.remove('active');
        });
        document.querySelectorAll('.nav-item')[0].classList.add('active');
    }

    function showProfile() {
        alert('Profile view would show here');
    }

    function navigateTo(page) {
        alert(`Navigating to ${page} page...`);
    }

    function bookService(service) {
        alert(`Booking ${service} service...`);
    }

    function bookNow() { alert('Opening booking system...'); }
    function callUs() { alert('Calling (555) 123-4567...'); }
    function viewOffers() { alert('Viewing current offers...'); }
    function rewards() { alert('Viewing rewards program...'); }
    function openAI() { 
        const input = document.getElementById('chatInput');
        if (input) input.focus();
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
        loadProducts();
        addChatMessage('bot', 'Hello! I\'m your beauty assistant. Ask me about skincare, products, or salon services!');
    });
  </script>
</body>
</html>

